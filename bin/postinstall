#!/bin/bash

set -e

. ${INSTALLER_DIR}/wizard

if [ -f "/usr/share/debconf/confmodule" ] ; then
	. /usr/share/debconf/confmodule

	if db_get "${APP_NAME}/mysql/autoinstall" && ! [ "$RET" = "skip" ] ; then
		rm -rf /etc/${APP_NAME}/mysql
	fi

	if db_get "${APP_NAME}/server/autoinstall" && [ "$RET" = "true" ] ; then
		a2dissite ${APP_NAME} || true
		rm -rf /etc/${APP_NAME}/apache2
		# TODO: remove server/* debconf values
	fi

	if db_get "${APP_NAME}/smtp/method" ; then
		rm -f /etc/${APP_NAME}/conf.d/smtp
		# remove debconf values
	fi

	if db_get "${APP_NAME}/svn-dav/autoinstall" && [ "$RET" = "true" ] ; then
		rm -f /etc/${APP_NAME}/conf.d/sys-api-key
		rm -f /etc/${APP_NAME}/conf.d/svn-dav
		# TODO remove debconf values
	fi
fi
